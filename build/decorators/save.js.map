{"version":3,"sources":["../../src/decorators/save.js"],"names":["micro","client","key","value","tags","Promise","resolve","reject","hash","type","JSON","stringify","hmset","err","result","logger","error","code","message"],"mappings":";;;;;;AAAA;;;;;;kBAEe,UAACA,KAAD,EAAQC,MAAR;AAAA,SAAmB,UAACC,GAAD,EAAMC,KAAN;AAAA,mFAA6B,EAA7B;AAAA,yBAAeC,IAAf;AAAA,QAAeA,IAAf,6BAAsB,EAAtB;;AAAA,WAAoC,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACrG,UAAMC,OAAO,CACX,MADW,EACF,iBAAOC,IAAP,CAAYN,KAAZ,CADE,EAEX,OAFW,EAEFO,KAAKC,SAAL,CAAeR,KAAf,CAFE,CAAb;;AAKAF,aAAOW,KAAP,gBAAaV,GAAb,SAAqBM,IAArB,GAA2B,UAAUK,GAAV,EAAeC,MAAf,EAAuB;AAChD,YAAID,GAAJ,EAAS;AACPb,gBAAMe,MAAN,CAAaC,KAAb,CAAmBH,GAAnB;AACA,iBAAON,OAAO;AACZU,oDAA0CJ,IAAII,IADlC;AAEZC,2JAAqChB,GAArC;AAFY,WAAP,CAAP;AAID;;AAEDI,gBAAQH,KAAR;AACD,OAVD;AAWD,KAjBqE,CAApC;AAAA,GAAnB;AAAA,C","file":"save.js","sourcesContent":["import upcast from '../utils/upcast';\n\nexport default (micro, client) => (key, value, { tags = [] } = {}) => new Promise((resolve, reject) => {\n  const hash = [\n    'type' , upcast.type(value),\n    'value', JSON.stringify(value)\n  ];\n\n  client.hmset(key, ...hash, function (err, result) {\n    if (err) {\n      micro.logger.error(err);\n      return reject({\n        code   : `error.plugin-cache-redis.set/${ err.code }`,\n        message: `Попытка установки ключа ${ key } привела к ошибке`\n      });\n    }\n\n    resolve(value);\n  });\n});"]}