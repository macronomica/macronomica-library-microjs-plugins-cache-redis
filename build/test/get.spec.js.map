{"version":3,"sources":["../../src/test/get.spec.js"],"names":["should","micro","before","done","args","after","queue","raw","case","logger","error","console","err","plugin","Date","now","KEY","describe","it","read","then","equal","result","write","id","be","a","del","data","Promise","resolve"],"mappings":";;AAAA;;;;AACA;;;;;;;;AAEA,IAAMA,SAAS,eAAKA,MAAL,EAAf;AACA,IAAMC,QAAQ;AACZC,UAAQ,EAAEC,MAAM,gBAAM,CAAE,CAAhB,EAAkBC,MAAM,EAAxB,EADI;AAEZC,SAAQ,EAAEF,MAAM,gBAAM,CAAE,CAAhB,EAAkBC,MAAM,EAAxB,EAFI;AAGZE,SAAQ,eAACC,GAAD,EAAS;;AAEf,YAAQA,IAAIC,IAAZ;AACE,WAAK,MAAL;AAAcP,cAAMC,MAAN,GAAeK,GAAf,CAAoB;AAClC,WAAK,OAAL;AAAcN,cAAMI,KAAN,GAAcE,GAAd,CAAmB;AAFnC;;AAKA,WAAON,KAAP;AACD,GAXW;AAYZQ,UAAQ;AACNC,WAAO;AAAA,aAAOC,QAAQD,KAAR,CAAcE,GAAd,CAAP;AAAA;AADD;AAZI,CAAd;;AAiBA,IAAMC,SAAS,qBAAO,EAAP,EAAWZ,KAAX,EAAkB,MAAlB,EAA0Ba,KAAKC,GAAL,EAA1B,CAAf;AACA,IAAMC,MAAM,UAAZ;;AAEAd,OAAO;AAAA;;AAAA,SAAM,uBAAMA,MAAN,EAAaC,IAAb,yCAAqBF,MAAMC,MAAN,CAAaE,IAAlC,EAAN;AAAA,CAAP;;AAEAC,MAAM;AAAA;;AAAA,SAAM,sBAAMA,KAAN,EAAYF,IAAZ,wCAAoBF,MAAMI,KAAN,CAAYD,IAAhC,EAAN;AAAA,CAAN;;AAEAa,SAAS,cAAT,EAAyB,YAAW;;AAElCC,KAAG,qCAAH,EAA0C;AAAA,WACxCL,OACGM,IADH,CACQH,GADR,EAEGI,IAFH,CAEQ;AAAA,aAAUpB,OAAOqB,KAAP,CAAa,IAAb,EAAmBC,MAAnB,CAAV;AAAA,KAFR,CADwC;AAAA,GAA1C;;AAMAJ,KAAG,sDAAH,EAA2D;AAAA,WACzDL,OACGU,KADH,CACSP,GADT,EACc,EAAEQ,IAAI,CAAN,EADd,EAEGJ,IAFH,CAEQ;AAAA,aAAMP,OAAOM,IAAP,CAAYH,GAAZ,CAAN;AAAA,KAFR,EAGGI,IAHH,CAGQ,kBAAU;AACdE,aAAOtB,MAAP,CAAcyB,EAAd,CAAiBC,CAAjB,CAAmB,QAAnB;AACA1B,aAAOqB,KAAP,CAAa,CAAb,EAAgBC,OAAOE,EAAvB;AACD,KANH,EAOGJ,IAPH,CAOQ;AAAA,aAAMP,OAAOc,GAAP,CAAWX,GAAX,CAAN;AAAA,KAPR,CADyD;AAAA,GAA3D;;AAYAE,KAAG,kDAAH,EAAuD,YAAM;AAC3D,QAAMU,OAAO,EAAEJ,IAAI,CAAN,EAAb;;AAEA,WAAOX,OACJM,IADI,CACCH,GADD,EACM;AAAA,aAAOY,IAAP;AAAA,KADN,EAEJR,IAFI,CAEC;AAAA,aAAUpB,OAAOqB,KAAP,CAAaO,IAAb,EAAmBN,MAAnB,CAAV;AAAA,KAFD,EAGJF,IAHI,CAGC;AAAA,aAAMP,OAAOc,GAAP,CAAWX,GAAX,CAAN;AAAA,KAHD,CAAP;AAID,GAPD;;AASAE,KAAG,4DAAH,EAAiE,YAAM;AACrE,QAAMU,OAAO,EAAEJ,IAAI,CAAN,EAAb;;AAEA,WAAOX,OACJM,IADI,CACCH,GADD,EACM;AAAA,aAAOa,QAAQC,OAAR,CAAgBF,IAAhB,CAAP;AAAA,KADN,EAEJR,IAFI,CAEC;AAAA,aAAUpB,OAAOqB,KAAP,CAAaO,IAAb,EAAmBN,MAAnB,CAAV;AAAA,KAFD,EAGJF,IAHI,CAGC;AAAA,aAAMP,OAAOc,GAAP,CAAWX,GAAX,CAAN;AAAA,KAHD,CAAP;AAID,GAPD;AAQD,CArCD","file":"get.spec.js","sourcesContent":["import chai from 'chai';\nimport Plugin from '../index';\n\nconst should = chai.should();\nconst micro = {\n  before: { done: () => {}, args: [] },\n  after : { done: () => {}, args: [] },\n  queue : (raw) => {\n    \n    switch (raw.case) {\n      case 'wait' : micro.before = raw; break;\n      case 'close': micro.after = raw; break;\n    }\n    \n    return micro;\n  },\n  logger: {\n    error: err => console.error(err)\n  }\n};\n\nconst plugin = Plugin({})(micro, 'test', Date.now());\nconst KEY = 'test-key';\n\nbefore(() => micro.before.done(...micro.before.args));\n\nafter(() => micro.after.done(...micro.after.args));\n\ndescribe('read / write', function() {\n  \n  it('#plugin.read -> должен вернуть null', () =>\n    plugin\n      .read(KEY)\n      .then(result => should.equal(null, result))\n  );\n  \n  it('#plugin.write + plugin.read -> должен вернуть объект', () =>\n    plugin\n      .write(KEY, { id: 1 })\n      .then(() => plugin.read(KEY))\n      .then(result => {\n        result.should.be.a('object');\n        should.equal(1, result.id);\n      })\n      .then(() => plugin.del(KEY))\n  );\n  \n  \n  it('#plugin.read + callback -> должен вернуть объект', () => {\n    const data = { id: 1 };\n    \n    return plugin\n      .read(KEY, key => data)\n      .then(result => should.equal(data, result))\n      .then(() => plugin.del(KEY));\n  });\n  \n  it('#plugin.read + callback():Promise -> должен вернуть объект', () => {\n    const data = { id: 1 };\n    \n    return plugin\n      .read(KEY, key => Promise.resolve(data))\n      .then(result => should.equal(data, result))\n      .then(() => plugin.del(KEY));\n  });\n});"]}