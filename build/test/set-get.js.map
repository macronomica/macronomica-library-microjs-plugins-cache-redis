{"version":3,"sources":["../../src/test/set-get.js"],"names":["micro","logger","error","console","err","client","createClient","delWrapper","getWrapper","setWrapper","getNullValue","then","getValueAsCallback","getValue","setValue","Promise","all","quit","success","log","key","id","result"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,QAAQ;AACZC,UAAQ,EAAEC,OAAO;AAAA,aAAOC,QAAQD,KAAR,CAAcE,GAAd,CAAP;AAAA,KAAT;AADI,CAAd;AAGA,IAAMC,SAAS,gBAAWC,YAAX,EAAf;;AAEA,IAAMC,aAAa,sBAAIP,KAAJ,EAAWK,MAAX,CAAnB;AACA,IAAMG,aAAa,sBAAIR,KAAJ,EAAWK,MAAX,CAAnB;AACA,IAAMI,aAAa,sBAAIT,KAAJ,EAAWK,MAAX,CAAnB;;AAEAK,eACGC,IADH,CACQC,kBADR,EAEGD,IAFH,CAEQE,QAFR,EAGGF,IAHH,CAGQG,QAHR,EAIGH,IAJH,CAIQ;AAAA,SAAMI,QAAQC,GAAR,CAAY,CACtBT,WAAW,UAAX,CADsB,EAEtBA,WAAW,aAAX,CAFsB,EAGtBA,WAAW,iBAAX,CAHsB,CAAZ,CAAN;AAAA,CAJR,EASGI,IATH,CASQ;AAAA,SAAMN,OAAOY,IAAP,EAAN;AAAA,CATR;;AAYA,SAASP,YAAT,GAAwB;AACtB,SAAOF,WAAW,UAAX,EAAuBG,IAAvB,CAA4BO,OAA5B,EAAqChB,KAArC,CAAP;AACD;;AAED,SAASU,kBAAT,GAA8B;AAC5B,SAAOJ,WAAW,aAAX,EAA0B,eAAO;AACtCL,YAAQgB,GAAR,6FAAiCC,GAAjC;AACA,WAAO,EAAEC,IAAI,CAAN,EAAP;AACD,GAHM,EAGJV,IAHI,CAGCO,OAHD,EAGUhB,KAHV,CAAP;AAID;;AAED,SAASW,QAAT,GAAoB;AAClB,SAAOL,WAAW,aAAX,EAA0BG,IAA1B,CAA+BO,OAA/B,EAAwChB,KAAxC,CAAP;AACD;;AAED,SAASY,QAAT,GAAoB;AAClB,SAAOL,WAAW,iBAAX,EAA8B,EAAEY,IAAI,CAAN,EAA9B,EAAyCV,IAAzC,CAA8CO,OAA9C,EAAuDhB,KAAvD,CAAP;AACD;;AAED,SAASgB,OAAT,CAAiBI,MAAjB,EAAyB;AACvBnB,UAAQgB,GAAR,CAAYG,MAAZ;AACD;;AAED,SAASpB,KAAT,CAAeA,KAAf,EAAsB;AACpBC,UAAQD,KAAR,CAAcA,KAAd;AACD","file":"set-get.js","sourcesContent":["import middleware from 'redis';\nimport get from './../get-key';\nimport del from './../del-key';\nimport set from './../set-key';\n\nconst micro = {\n  logger: { error: err => console.error(err) }\n};\nconst client = middleware.createClient();\n\nconst delWrapper = del(micro, client);\nconst getWrapper = get(micro, client);\nconst setWrapper = set(micro, client);\n\ngetNullValue()\n  .then(getValueAsCallback)\n  .then(getValue)\n  .then(setValue)\n  .then(() => Promise.all([\n    delWrapper('test-get'),\n    delWrapper('test-run-cb'),\n    delWrapper('test-set-object')\n  ]))\n  .then(() => client.quit())\n;\n\nfunction getNullValue() {\n  return getWrapper('test-get').then(success, error);\n}\n\nfunction getValueAsCallback() {\n  return getWrapper('test-run-cb', key => {\n    console.log(`Данных для ключа ${ key } нет, вставляем новые`);\n    return { id: 1 };\n  }).then(success, error);\n}\n\nfunction getValue() {\n  return getWrapper('test-run-cb').then(success, error);\n}\n\nfunction setValue() {\n  return setWrapper('test-set-object', { id: 2 }).then(success, error);\n}\n\nfunction success(result) {\n  console.log(result);\n}\n\nfunction error(error) {\n  console.error(error);\n}"]}